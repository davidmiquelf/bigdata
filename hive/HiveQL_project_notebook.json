{"paragraphs":[{"text":"%md\n### Hive Table with GS input file.\nI created a table that uses Google Storage for the input file (LOCATION).  ","user":"anonymous","dateUpdated":"2019-09-17T20:49:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Hive Table with GS input file.</h3>\n<p>I created a table that uses Google Storage for the input file (LOCATION).</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1568750437561_1695833538","id":"20190917-200037_1500137184","dateCreated":"2019-09-17T20:00:37+0000","dateStarted":"2019-09-17T20:49:07+0000","dateFinished":"2019-09-17T20:49:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:439"},{"text":"%spark.sql\nDROP TABLE IF EXISTS wdi_gs","user":"anonymous","dateUpdated":"2019-09-17T20:19:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1566401567656_1956554786","id":"20190821-153247_317899003","dateCreated":"2019-08-21T15:32:47+0000","dateStarted":"2019-09-17T20:19:00+0000","dateFinished":"2019-09-17T20:19:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:440"},{"text":"%spark.sql\nCREATE EXTERNAL TABLE wdi_gs\n(year INTEGER, countryName STRING, countryCode STRING, indicatorName STRING, indicatorCode STRING, indicatorValue FLOAT)\nROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\\n'\nLOCATION 'gs://jrvs-bootcamp-david/wdi_2016'\nTBLPROPERTIES (\"skip.header.line.count\"=\"1\")","user":"anonymous","dateUpdated":"2019-09-17T20:38:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1566401577137_-1697244568","id":"20190821-153257_523958211","dateCreated":"2019-08-21T15:32:57+0000","dateStarted":"2019-09-17T20:37:03+0000","dateFinished":"2019-09-17T20:37:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:441"},{"text":"%md\n### GS data to Hive External Table\nAccessing Google Storage is slow, so I copied the data to hdfs text files by creating an external table.  \nCreate the an external table wdi_csv_text, then insert the data from wdi_gs.  \nThe row format is simple: it assumes each field is delimited by a comma, and each line by '\\n'. It does not check for escape characters.","user":"anonymous","dateUpdated":"2019-09-17T20:49:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>GS data to Hive External Table</h3>\n<p>Accessing Google Storage is slow, so I copied the data to hdfs text files by creating an external table.<br/>Create the an external table wdi_csv_text, then insert the data from wdi_gs.<br/>The row format is simple: it assumes each field is delimited by a comma, and each line by &lsquo;\\n&rsquo;. It does not check for escape characters.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1568751492467_1469812297","id":"20190917-201812_1506075419","dateCreated":"2019-09-17T20:18:12+0000","dateStarted":"2019-09-17T20:49:13+0000","dateFinished":"2019-09-17T20:49:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:442"},{"text":"%spark.sql\nDROP TABLE IF EXISTS wdi_csv_text","user":"anonymous","dateUpdated":"2019-09-17T20:36:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1568751416920_781173724","id":"20190917-201656_1221903330","dateCreated":"2019-09-17T20:16:56+0000","dateStarted":"2019-09-17T20:36:39+0000","dateFinished":"2019-09-17T20:36:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:443"},{"text":"%spark.sql\nCREATE EXTERNAL TABLE wdi_csv_text\n(year INTEGER, countryName STRING, countryCode STRING, indicatorName STRING, indicatorCode STRING, indicatorValue FLOAT)\nROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\\n'\nLOCATION 'hdfs:///user/hive/warehouse/wdi/wdi_csv_text'","user":"anonymous","dateUpdated":"2019-09-17T20:38:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1568751371419_202282102","id":"20190917-201611_1262180374","dateCreated":"2019-09-17T20:16:11+0000","dateStarted":"2019-09-17T20:36:45+0000","dateFinished":"2019-09-17T20:36:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:444"},{"text":"%spark.sql\nINSERT OVERWRITE TABLE wdi_csv_text\nSELECT * FROM wdi_gs","user":"anonymous","dateUpdated":"2019-09-17T20:40:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1568751500009_-1280557607","id":"20190917-201820_1497837602","dateCreated":"2019-09-17T20:18:20+0000","dateStarted":"2019-09-17T20:37:18+0000","dateFinished":"2019-09-17T20:39:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:445"},{"text":"%md\n### Parsing Issue\nThere is a parsing issue with wdi_csv_text due to the limitaitons of the row format. Certain characters need to be properly escaped.  \nThis can be seen with a simple query.","user":"anonymous","dateUpdated":"2019-09-17T21:18:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Parsing Issue</h3>\n<p>There is a parsing issue with wdi_csv_text due to the limitaitons of the row format. Certain characters need to be properly escaped.<br/>This can be seen with a simple query.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1568752166934_-1968915972","id":"20190917-202926_850174714","dateCreated":"2019-09-17T20:29:26+0000","dateStarted":"2019-09-17T21:18:49+0000","dateFinished":"2019-09-17T21:18:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:446"},{"text":"%spark.sql\nSELECT distinct(indicatorCode)\nFROM wdi_csv_text\norder by indicatorCode\nlimit 20\n","user":"anonymous","dateUpdated":"2019-09-17T21:18:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"indicatorCode":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"indicatorCode\n % of exports of goods\n %)\"\n (% of urban population)\"\n 15+\n Atlas method (current US$)\"\n Australia (current US$)\"\n Austria (current US$)\"\n Belgium (current US$)\"\n BoP)\"\n Canada (current US$)\"\n Czech Republic (current US$)\"\n DPT (% of children ages 12-23 months)\"\n Denmark (current US$)\"\n Deutsche mark (%)\"\n Euro (%)\"\n European Union institutions (current US$)\"\n Finland (current US$)\"\n France (current US$)\"\n French franc (%)\"\n GDP (LCU per international $)\"\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1568752284903_-1072150182","id":"20190917-203124_1879479958","dateCreated":"2019-09-17T20:31:24+0000","dateStarted":"2019-09-17T20:40:07+0000","dateFinished":"2019-09-17T20:40:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:447"},{"text":"%md\n### Debug Table\nTo get a better look at the raw data causing this problem, make a debug table that does not parse the lines.\n","user":"anonymous","dateUpdated":"2019-09-17T20:49:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Debug Table</h3>\n<p>To get a better look at the raw data causing this problem, make a debug table that does not parse the lines.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1568752891445_689646230","id":"20190917-204131_49978260","dateCreated":"2019-09-17T20:41:31+0000","dateStarted":"2019-09-17T20:49:23+0000","dateFinished":"2019-09-17T20:49:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:448"},{"text":"%spark.sql\nDROP TABLE IF EXISTS wdi_gs_debug","user":"anonymous","dateUpdated":"2019-09-17T20:43:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568752978443_-1464756227","id":"20190917-204258_1620371222","dateCreated":"2019-09-17T20:42:58+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:449"},{"text":"%spark.sql\nCREATE EXTERNAL TABLE wdi_gs_debug\n(line STRING)\nLOCATION 'gs://jrvs-bootcamp-david/wdi_2016'","user":"anonymous","dateUpdated":"2019-09-17T20:46:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1568753006990_-211941944","id":"20190917-204326_633820788","dateCreated":"2019-09-17T20:43:26+0000","dateStarted":"2019-09-17T20:46:40+0000","dateFinished":"2019-09-17T20:46:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:450"},{"text":"%spark.sql\nSELECT DISTINCT(line)\nfrom wdi_gs_debug\nwhere line like \"%(\\% of urban population)\\\"%\"\nlimit 10","user":"anonymous","dateUpdated":"2019-09-17T20:48:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"line":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"tableHide":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"line\n1975,Uganda,UGA,\"Population living in slums, (% of urban population)\",EN.POP.SLUM.UR.ZS,0\n2009,Croatia,HRV,\"People practicing open defecation, urban (% of urban population)\",SH.STA.ODFC.UR.ZS,0.3\n1969,Georgia,GEO,\"Access to non-solid fuel, urban (% of urban population)\",EG.NSF.ACCS.UR.ZS,0\n2000,Somalia,SOM,\"Access to non-solid fuel, urban (% of urban population)\",EG.NSF.ACCS.UR.ZS,0\n2015,Vietnam,VNM,\"Access to electricity, urban (% of urban population)\",EG.ELC.ACCS.UR.ZS,0\n1977,Saudi Arabia,SAU,\"Access to electricity, urban (% of urban population)\",EG.ELC.ACCS.UR.ZS,0\n2003,Sub-Saharan Africa (IDA & IBRD countries),TSS,\"People practicing open defecation, urban (% of urban population)\",SH.STA.ODFC.UR.ZS,9.04777042739112\n2003,Uganda,UGA,\"Access to electricity, urban (% of urban population)\",EG.ELC.ACCS.UR.ZS,0\n1975,Bangladesh,BGD,\"Access to non-solid fuel, urban (% of urban population)\",EG.NSF.ACCS.UR.ZS,0\n1967,Northern Mariana Islands,MNP,\"People practicing open defecation, urban (% of urban population)\",SH.STA.ODFC.UR.ZS,0\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1568753061204_-1035429631","id":"20190917-204421_500603524","dateCreated":"2019-09-17T20:44:21+0000","dateStarted":"2019-09-17T20:46:47+0000","dateFinished":"2019-09-17T20:47:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:451"},{"text":"%md\n### OpenCSVSerde\nFrom the debug table we can see that the row format needs escape characters for commas within strings, so I upgraded with an open source serde.  \nCreate the table wdi_opencsv_gs on GS input, but this time use OpenCSVSerde for the row format.","user":"anonymous","dateUpdated":"2019-09-17T21:18:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568750788263_-391467989","id":"20190917-200628_1801221636","dateCreated":"2019-09-17T20:06:28+0000","dateStarted":"2019-09-17T21:18:55+0000","dateFinished":"2019-09-17T21:18:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:452","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>OpenCSVSerde</h3>\n<p>From the debug table we can see that the row format needs escape characters for commas within strings, so I upgraded with an open source serde.<br/>Create the table wdi_opencsv_gs on GS input, but this time use OpenCSVSerde for the row format.</p>\n</div>"}]}},{"text":"%spark.sql\nDROP TABLE IF EXISTS wdi_opencsv_gs","user":"anonymous","dateUpdated":"2019-08-21T15:31:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566401438233_-1878089006","id":"20190821-153038_103081891","dateCreated":"2019-08-21T15:30:38+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:453"},{"text":"%spark.sql\r\nCREATE EXTERNAL TABLE wdi_opencsv_gs\r\n(year INTEGER, countryName STRING, countryCode STRING, indicatorName STRING, indicatorCode STRING, indicatorValue FLOAT)\r\nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\r\nWITH SERDEPROPERTIES (\r\n\"seperatorChar\" = \",\",\r\n\"quoteChar\" = \"\\\"\",\r\n\"escapeChar\" = \"\\\\\"\r\n)\r\nLOCATION 'gs://jrvs-bootcamp-david/wdi_2016'","user":"anonymous","dateUpdated":"2019-08-21T15:31:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566401375040_392033337","id":"20190821-152935_200020513","dateCreated":"2019-08-21T15:29:35+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:454"},{"text":"%md\n### Hive External Table with OpenCSV\nOnce again I created an external hive table on the hdfs, this time with OpenCSVSerde.  \nFirst create the wdi_opencsv_text table with an hdfs location, then copy the data from the gs table with an insert statement.","user":"anonymous","dateUpdated":"2019-09-17T20:49:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Hive External Table with OpenCSV</h3>\n<p>Once again I created an external hive table on the hdfs, this time with OpenCSVSerde.<br/>First create the wdi_opencsv_text table with an hdfs location, then copy the data from the gs table with an insert statement.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1568751817181_-196897906","id":"20190917-202337_2090757933","dateCreated":"2019-09-17T20:23:37+0000","dateStarted":"2019-09-17T20:49:56+0000","dateFinished":"2019-09-17T20:49:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:455"},{"text":"%spark.sql\nDROP TABLE IF EXISTS wdi_opencsv_text","user":"anonymous","dateUpdated":"2019-09-17T20:16:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568751393480_1969452544","id":"20190917-201633_1050723660","dateCreated":"2019-09-17T20:16:33+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:456"},{"text":"%spark.sql\r\nCREATE EXTERNAL TABLE wdi_opencsv_text\r\n(year INTEGER, countryName STRING, countryCode STRING, indicatorName STRING, indicatorCode STRING, indicatorValue FLOAT)\r\nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\r\nLOCATION 'hdfs:///user/hive/warehouse/wdi/wdi_opencsv_text'","user":"anonymous","dateUpdated":"2019-09-17T20:16:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566401480404_-544161287","id":"20190821-153120_1683712334","dateCreated":"2019-08-21T15:31:20+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:457"},{"text":"%spark.sql\nINSERT OVERWRITE TABLE wdi_opencsv_text\nSELECT * FROM wdi_opencsv_gs","user":"anonymous","dateUpdated":"2019-08-21T15:32:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566401558146_-894647626","id":"20190821-153238_1084453868","dateCreated":"2019-08-21T15:32:38+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:458"},{"text":"%md\n### Datatypes with OpenCSV\nWhen comparing the two hive external tables wdi_csv_text and wdi_opencsv_text, we can see that opencsv only uses the string datatype.","user":"anonymous","dateUpdated":"2019-09-17T21:23:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568755270953_-48831525","id":"20190917-212110_1481495757","dateCreated":"2019-09-17T21:21:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12145","dateFinished":"2019-09-17T21:23:01+0000","dateStarted":"2019-09-17T21:23:01+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Datatypes with OpenCSV</h3>\n<p>When comparing the two hive external tables wdi_csv_text and wdi_opencsv_text, we can see that opencsv only uses the string datatype.</p>\n</div>"}]}},{"text":"%spark.sql\nDESCRIBE FORMATTED wdi_csv_text","user":"anonymous","dateUpdated":"2019-09-17T21:22:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568755232126_-1239348728","id":"20190917-212032_2037882291","dateCreated":"2019-09-17T21:20:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11093","dateFinished":"2019-09-17T21:20:48+0000","dateStarted":"2019-09-17T21:20:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"col_name\tdata_type\tcomment\nyear\tint\tnull\ncountryName\tstring\tnull\ncountryCode\tstring\tnull\nindicatorName\tstring\tnull\nindicatorCode\tstring\tnull\nindicatorValue\tfloat\tnull\n\t\t\n# Detailed Table Information\t\t\nDatabase\tdefault\t\nTable\twdi_csv_text\t\nOwner\tzeppelin\t\nCreated Time\tTue Sep 17 20:36:48 UTC 2019\t\nLast Access\tThu Jan 01 00:00:00 UTC 1970\t\nCreated By\tSpark 2.3.3\t\nType\tEXTERNAL\t\nProvider\thive\t\nTable Properties\t[transient_lastDdlTime=1568752774]\t\nStatistics\t1838963153 bytes\t\nLocation\thdfs://jarvis-bootcamp-m/user/hive/warehouse/wdi/wdi_csv_text\t\nSerde Library\torg.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\t\nInputFormat\torg.apache.hadoop.mapred.TextInputFormat\t\nOutputFormat\torg.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\t\nStorage Properties\t[line.delim=\n, field.delim=,, serialization.format=,]\t\nPartition Provider\tCatalog\t\n"}]}},{"text":"%spark.sql\nDESCRIBE FORMATTED wdi_opencsv_text","user":"anonymous","dateUpdated":"2019-09-17T21:21:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568755178055_1777388869","id":"20190917-211938_1173742105","dateCreated":"2019-09-17T21:19:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9872","dateFinished":"2019-09-17T21:20:05+0000","dateStarted":"2019-09-17T21:20:05+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"col_name\tdata_type\tcomment\nyear\tstring\tfrom deserializer\ncountryname\tstring\tfrom deserializer\ncountrycode\tstring\tfrom deserializer\nindicatorname\tstring\tfrom deserializer\nindicatorcode\tstring\tfrom deserializer\nindicatorvalue\tstring\tfrom deserializer\n\t\t\n# Detailed Table Information\t\t\nDatabase\tdefault\t\nTable\twdi_opencsv_text\t\nOwner\tdavid_faig_jrvs_ca\t\nCreated Time\tWed Aug 21 14:53:38 UTC 2019\t\nLast Access\tThu Jan 01 00:00:00 UTC 1970\t\nCreated By\tSpark 2.2 or prior\t\nType\tEXTERNAL\t\nProvider\thive\t\nTable Properties\t[transient_lastDdlTime=1566399328]\t\nStatistics\t2422984947 bytes, 21759413 rows\t\nLocation\thdfs://jarvis-bootcamp-m/user/hive/warehouse/wdi/wdi_opencsv_text\t\nSerde Library\torg.apache.hadoop.hive.serde2.OpenCSVSerde\t\nInputFormat\torg.apache.hadoop.mapred.TextInputFormat\t\nOutputFormat\torg.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\t\nStorage Properties\t[serialization.format=1]\t\nPartition Provider\tCatalog\t\n"}]}},{"text":"%md\n### Creating a view\nTo give the opencsv table different data types, we can make a view where we cast \"year as INTEGER\" and \"indicatorValue as FLOAT\".","user":"anonymous","dateUpdated":"2019-09-17T22:02:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568755388339_-1405007938","id":"20190917-212308_1712535146","dateCreated":"2019-09-17T21:23:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12276","dateFinished":"2019-09-17T22:02:07+0000","dateStarted":"2019-09-17T22:02:07+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Creating a view</h3>\n<p>To give the opencsv table different data types, we can make a view where we cast &ldquo;year as INTEGER&rdquo; and &ldquo;indicatorValue as FLOAT&rdquo;.</p>\n</div>"}]}},{"text":"%spark.sql\nDROP VIEW IF EXISTS wdi_opencsv_text_view","user":"anonymous","dateUpdated":"2019-08-21T15:33:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566401586544_-1897911611","id":"20190821-153306_841596603","dateCreated":"2019-08-21T15:33:06+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:459"},{"text":"%spark.sql\nCREATE VIEW IF NOT EXISTS wdi_opencsv_text_view\nAS\nSELECT cast(year as INTEGER),\n countryName,\n countryCode,\n indicatorName, \n indicatorCode, \n cast(indicatorValue as FLOAT)\nFROM wdi_opencsv_text","user":"anonymous","dateUpdated":"2019-09-17T21:18:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[],"values":[]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1566401608971_-1346565609","id":"20190821-153328_2092797616","dateCreated":"2019-08-21T15:33:28+0000","dateStarted":"2019-08-21T15:33:34+0000","dateFinished":"2019-08-21T15:33:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:460"},{"text":"%md\n### HQL Queries\nTo find the annual GDP growth of Canada, I first need the indicator code for GDP growth, so I construct a query that finds rows with GDP growth in their indicator name.  \nThen I use that indicator code to find Canada's GDP growth in 2015.","user":"anonymous","dateUpdated":"2019-09-17T22:06:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568757774440_-546444532","id":"20190917-220254_828419705","dateCreated":"2019-09-17T22:02:54+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12518"},{"text":"%spark.sql\nSELECT distinct(indicatorCode), indicatorName\nFROM wdi_opencsv_text_view\nWHERE indicatorname like '%GDP growth%'","user":"anonymous","dateUpdated":"2019-09-17T22:06:35+0000","config":{"colWidth":11,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":94,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"indicatorCode","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"indicatorName","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"indicatorCode":"string","indicatorName":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"indicatorCode\tindicatorName\nNY.GDP.MKTP.KD.ZG\tGDP growth (annual %)\n"}]},"apps":[],"jobName":"paragraph_1566401614405_1027933367","id":"20190821-153334_1843974122","dateCreated":"2019-08-21T15:33:34+0000","dateStarted":"2019-09-17T22:06:35+0000","dateFinished":"2019-09-17T22:08:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:461","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=7","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=8","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=9","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=10","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}}},{"text":"%spark.sql\nSELECT indicatorValue, year, countryName\nFROM wdi_opencsv_text\nWHERE indicatorCode = 'NY.GDP.MKTP.KD.ZG'\nAND year = '2015'\nAND countryName = 'Canada'","user":"anonymous","dateUpdated":"2019-09-17T22:11:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"indicatorValue":"string","year":"string","countryName":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"indicatorValue","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"year","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"indicatorValue\tyear\tcountryName\n1.07826875075381\t2015\tCanada\n"}]},"apps":[],"jobName":"paragraph_1566401643427_-1268569035","id":"20190821-153403_216618050","dateCreated":"2019-08-21T15:34:03+0000","dateStarted":"2019-09-17T22:02:36+0000","dateFinished":"2019-09-17T22:04:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:462","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=4","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=5","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Partitions\nSearching for the exact row specifying Canada's GDP growth in 2015 took a long time because without any additional data structure, the engine has to search every single row.  \nTo solve this problem, I can create a similar Hive external table that partitions the rows by year. This means our above HQL query only has to search the partition (directory) labled 2015.","user":"anonymous","dateUpdated":"2019-09-17T22:11:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568757964165_-219314874","id":"20190917-220604_1455932818","dateCreated":"2019-09-17T22:06:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12955","dateFinished":"2019-09-17T22:08:36+0000","dateStarted":"2019-09-17T22:08:36+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Partitions</h3>\n<p>Searching for the exact row specifying Canada&rsquo;s GDP growth in 2015 took a long time because without any additional data structure, the engine has to search every single row.</p>\n</div>"}]}},{"text":"%spark.sql\nDROP TABLE IF EXISTS wdi_opencsv_text_partitions","user":"anonymous","dateUpdated":"2019-09-17T21:16:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1566401771232_1754045443","id":"20190821-153611_1685992354","dateCreated":"2019-08-21T15:36:11+0000","dateStarted":"2019-08-21T18:31:54+0000","dateFinished":"2019-08-21T18:31:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:463"},{"text":"%spark.sql\nCREATE EXTERNAL TABLE wdi_opencsv_text_partitions (\n    countryName STRING, countryCode STRING,\n    indicatorName STRING, indicatorCode STRING,\n    indicatorValue FLOAT\n) PARTITIONED BY (year STRING)\nROW FORMAT DELIMITED\nLOCATION 'hdfs:///user/hive/warehouse/wdi/wdi_opencsv_text_partitions'","user":"anonymous","dateUpdated":"2019-08-21T18:32:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1566401973696_369916504","id":"20190821-153933_693895796","dateCreated":"2019-08-21T15:39:33+0000","dateStarted":"2019-08-21T18:32:15+0000","dateFinished":"2019-08-21T18:32:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:464"},{"text":"%spark.sql\nset hive.exec.dynamic.partition.mode=nonstrict","user":"anonymous","dateUpdated":"2019-08-21T18:04:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"key":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"key\tvalue\nhive.exec.dynamic.partition.mode\tnonstrict\n"}]},"apps":[],"jobName":"paragraph_1566402099065_-2040953515","id":"20190821-154139_626423601","dateCreated":"2019-08-21T15:41:39+0000","dateStarted":"2019-08-21T18:04:29+0000","dateFinished":"2019-08-21T18:04:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:465"},{"text":"%spark.sql\nINSERT OVERWRITE TABLE wdi_opencsv_text_partitions PARTITION (year)\nSELECT countryName,\ncountryCode,\nindicatorName,\nindicatorCode,\nindicatorValue,\nYEAR\nFROM wdi_opencsv_text","user":"anonymous","dateUpdated":"2019-08-21T18:32:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1566402133581_-1144701636","id":"20190821-154213_1414078593","dateCreated":"2019-08-21T15:42:13+0000","dateStarted":"2019-08-21T18:32:25+0000","dateFinished":"2019-08-21T18:35:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:466"},{"text":"%spark.sql\nSET spark.sql.hive.metastorePartitionPruning=true","user":"anonymous","dateUpdated":"2019-08-21T18:26:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"key":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"key\tvalue\nspark.sql.hive.metastorePartitionPruning\ttrue\n"}]},"apps":[],"jobName":"paragraph_1566411106081_815461851","id":"20190821-181146_891796542","dateCreated":"2019-08-21T18:11:46+0000","dateStarted":"2019-08-21T18:18:23+0000","dateFinished":"2019-08-21T18:18:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:467"},{"text":"%spark.sql\nSELECT indicatorValue, year, countryName\nFROM wdi_opencsv_text_partitions\nWHERE YEAR=2015\nAND indicatorCode = 'NY.GDP.MKTP.KD.ZG'\nAND countryName = 'Canada'","user":"anonymous","dateUpdated":"2019-09-17T22:12:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"indicatorValue":"string","year":"string","countryName":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"indicatorValue\tyear\tcountryName\n1.0782688\t2015\tCanada\n"}]},"apps":[],"jobName":"paragraph_1566402219235_2051447242","id":"20190821-154339_1554432750","dateCreated":"2019-08-21T15:43:39+0000","dateStarted":"2019-09-17T22:11:16+0000","dateFinished":"2019-09-17T22:11:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:468","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=12","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=13","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=14"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Parquet files\nUp until now, we have been storing files in plain text default csv format.  \nTo improve on this we can use Parquet which not only compresses it but uses a columnar structure to optimize queries.","user":"anonymous","dateUpdated":"2019-09-17T22:24:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568758348204_-1667460895","id":"20190917-221228_387942383","dateCreated":"2019-09-17T22:12:28+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14049"},{"text":"%spark.sql\nDROP TABLE IF EXISTS wdi_csv_parquet","user":"anonymous","dateUpdated":"2019-08-21T18:38:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566412700569_-1534992903","id":"20190821-183820_1444848790","dateCreated":"2019-08-21T18:38:20+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:469"},{"text":"%spark.sql\nCREATE EXTERNAL TABLE wdi_csv_parquet (\n    year INTEGER,\n    countryName STRING, \n    countryCode STRING,\n    indicatorName STRING, \n    indicatorCode STRING,\n    indicatorValue FLOAT\n)\nSTORED AS PARQUET\nLOCATION 'hdfs:///user/hive/warehouse/wdi/wdi_csv_parquet'","user":"anonymous","dateUpdated":"2019-09-17T21:16:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1566410316041_-1127811962","id":"20190821-175836_1890585348","dateCreated":"2019-08-21T17:58:36+0000","dateStarted":"2019-08-21T18:39:05+0000","dateFinished":"2019-08-21T18:39:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:470"},{"text":"%spark.sql\nINSERT OVERWRITE TABLE wdi_csv_parquet\nSELECT * FROM wdi_opencsv_gs","user":"anonymous","dateUpdated":"2019-09-17T21:16:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1566412745806_466134316","id":"20190821-183905_833473439","dateCreated":"2019-08-21T18:39:05+0000","dateStarted":"2019-08-21T18:40:31+0000","dateFinished":"2019-08-21T18:42:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:471"},{"text":"%spark.sql\nselect count(countryName) FROM wdi_csv_parquet","user":"anonymous","dateUpdated":"2019-09-17T21:16:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"count(countryName)","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"count(countryName)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":true},"updated":false,"initialized":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"count(countryName)","index":0,"aggr":"sum"}],"groups":[],"values":[]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"count(countryName)\n21759413\n"}]},"apps":[],"jobName":"paragraph_1566412827808_-2002421397","id":"20190821-184027_1327103091","dateCreated":"2019-08-21T18:40:27+0000","dateStarted":"2019-08-21T19:15:06+0000","dateFinished":"2019-08-21T19:15:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:472"},{"text":"%spark.sql\nSELECT indicatorvalue, year, countryname\nFROM wdi_csv_parquet\nWHERE YEAR=2015\nAND indicatorCode = 'NY.GDP.MKTP.KD.ZG'","user":"anonymous","dateUpdated":"2019-09-17T21:16:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"indicatorvalue":"string","year":"string","countryname":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"indicatorvalue\tyear\tcountryname\n4.7859845\t2015\tSri Lanka\n3.1226985\t2015\tPre-demographic dividend\n0.0\t2015\tMonaco\n3.6497192\t2015\tPoland\n0.0\t2015\tSyrian Arab Republic\n3.3546362\t2015\tLate-demographic dividend\n0.0\t2015\tMiddle East & North Africa (IDA & IBRD countries)\n3.6641207\t2015\tAntigua and Barbuda\n3.1826782\t2015\tUnited Arab Emirates\n-0.05218131\t2015\tEurope & Central Asia (IDA & IBRD countries)\n1.0678406\t2015\tEstonia\n8.0\t2015\tUzbekistan\n4.817283\t2015\tHeavily indebted poor countries (HIPC)\n1.8869123\t2015\tLatvia\n1.5085671\t2015\tLebanon\n3.081928\t2015\tColombia\n3.016569\t2015\tMadagascar\n6.266542\t2015\tMozambique\n1.990585\t2015\tNetherlands\n3.979542\t2015\tBurkina Faso\n2.3826866\t2015\tJordan\n2.6526935\t2015\tNigeria\n1.5937746\t2015\tLithuania\n3.5345855\t2015\tMiddle income\n0.0\t2015\tAmerican Samoa\n6.4602604\t2015\tEast Asia & Pacific (excluding high income)\n3.3629532\t2015\tNepal\n2.7597404\t2015\tDominica\n4.1487846\t2015\tGuatemala\n2.4550622\t2015\tEl Salvador\n0.0\t2015\tYemen, Rep.\n3.4856565\t2015\tSaudi Arabia\n3.4195652\t2015\tFiji\n0.0\t2015\tAruba\n1.5980686\t2015\tNorway\n0.7260749\t2015\tSerbia\n4.693329\t2015\tLow income\n0.8000001\t2015\tTunisia\n1.5138842\t2015\tMaldives\n2.2578251\t2015\tAustralia\n3.4692807\t2015\tKyrgyz Republic\n2.9780598\t2015\tSub-Saharan Africa (excluding high income)\n3.0\t2015\tArmenia\n4.849233\t2015\tLuxembourg\n1.9133767\t2015\tHigh income\n6.5\t2015\tTurkmenistan\n6.953314\t2015\tDominican Republic\n2.4174573\t2015\tOther small states\n6.9\t2015\tChina\n0.29765758\t2015\tLiberia\n0.0\t2015\tBritish Virgin Islands\n0.0\t2015\tVirgin Islands (U.S.)\n2.997704\t2015\tAngola\n1.0782688\t2015\tCanada\n0.909637\t2015\tSwitzerland\n1.1785513\t2015\tDenmark\n3.9\t2015\tAlgeria\n-20.348732\t2015\tMacao SAR, China\n2.2954435\t2015\tMongolia\n0.0\t2015\tNew Caledonia\n7.1963625\t2015\tSouth Asia (IDA & IBRD)\n3.8827045\t2015\tGhana\n9.363092\t2015\tPalau\n-3.8876984\t2015\tBelarus\n4.30567\t2015\tIDA blend\n1.2832958\t2015\tSouth Africa\n2.9565039\t2015\tUpper middle income\n2.879161\t2015\tSlovenia\n6.9678717\t2015\tTanzania\n6.916188\t2015\tCongo, Dem. Rep.\n4.618098\t2015\tSt. Kitts and Nevis\n-10.2\t2015\tLibya\n6.904203\t2015\tRwanda\n0.9822586\t2015\tUruguay\n2.819683\t2015\tThailand\n1.1\t2015\tAzerbaijan\n3.3930275\t2015\tNew Zealand\n1.3739371\t2015\tBelgium\n0.0\t2015\tGibraltar\n1.6446133\t2015\tCroatia\n4.6299825\t2015\tIDA total\n3.522498\t2015\tIDA & IBRD total\n0.0\t2015\tPapua New Guinea\n5.476984\t2015\tLower middle income\n1.4519044\t2015\tSt. Vincent and the Grenadines\n3.2142863\t2015\tSpain\n2.4664042\t2015\tWorld\n2.54687\t2015\tMexico\n0.0\t2015\tSomalia\n3.6352625\t2015\tHonduras\n0.0\t2015\tSan Marino\n1.2204835\t2015\tBahamas, The\n0.0\t2015\tNot classified\n0.0\t2015\tNorthern Mariana Islands\n1.6516614\t2015\tHaiti\n0.0\t2015\tMalta\n-3.8473625\t2015\tBrazil\n1.5862063\t2015\tCyprus\n6.679289\t2015\tVietnam\n2.0083723\t2015\tSingapore\n2.9716482\t2015\tArab World\n5.8057284\t2015\tPhilippines\n1.4824823\t2015\tEurope & Central Asia\n-0.23157153\t2015\tGreece\n7.036087\t2015\tCambodia\n5.0659738\t2015\tIDA only\n0.0\t2015\tChannel Islands\n3.595021\t2015\tSlovak Republic\n1.155967\t2015\tFrance\n4.7967796\t2015\tGuinea-Bissau\n1.2\t2015\tKazakhstan\n5.663774\t2015\tNamibia\n4.0936375\t2015\tSweden\n2.4259706\t2015\tUnited States\n2.4880762\t2015\tIsrael\n2.9265673\t2015\tBahrain\n2.9671354\t2015\tBulgaria\n1.4544638\t2015\tPortugal\n7.1963625\t2015\tSouth Asia\n2.1\t2015\tIraq\n0.4727847\t2015\tJapan\n3.6244457\t2015\tKosovo\n0.0\t2015\tTuvalu\n5.042981\t2015\tUganda\n-2.5358655\t2015\tBurundi\n6.5526333\t2015\tBangladesh\n-0.5\t2015\tBrunei Darussalam\n3.5505407\t2015\tLow & middle income\n3.1575763\t2015\tBosnia and Herzegovina\n1.9826958\t2015\tFragile and conflict affected situations\n0.0\t2015\tAndorra\n3.4109857\t2015\tGrenada\n-20.301247\t2015\tSierra Leone\n3.8566837\t2015\tGabon\n2.9389157\t2015\tHungary\n4.9523706\t2015\tMalaysia\n3.497814\t2015\tSeychelles\n4.251\t2015\tTimor-Leste\n2.2926679\t2015\tNorth America\n2.3291833\t2015\tUnited Kingdom\n1.3222066\t2015\tCaribbean small states\n0.0\t2015\tBermuda\n9.607518\t2015\tEthiopia\n1.0734317\t2015\tZimbabwe\n1.6573873\t2015\tSwaziland\n12.393243\t2015\tWest Bank and Gaza\n6.4602604\t2015\tEast Asia & Pacific (IDA & IBRD countries)\n-0.65439725\t2015\tEurope & Central Asia (excluding high income)\n2.95\t2015\tMalawi\n0.0\t2015\tEritrea\n-9.899983\t2015\tUkraine\n3.144654\t2015\tKiribati\n0.0\t2015\tMauritania\n3.961728\t2015\tBolivia\n-0.25473318\t2015\tBotswana\n3.8858001\t2015\tEast Asia & Pacific\n6.9952254\t2015\tLao PDR\n3.2568998\t2015\tPeru\n2.978459\t2015\tSub-Saharan Africa\n0.990099\t2015\tBarbados\n2.2674015\t2015\tSmall states\n3.2539856\t2015\tSolomon Islands\n0.0\t2015\tMicronesia, Fed. Sts.\n2.9080288\t2015\tMiddle East & North Africa\n3.3978221\t2015\tCentral Europe and the Baltics\n0.0\t2015\tFaroe Islands\n0.0\t2015\tGuam\n0.0\t2015\tMarshall Islands\n3.5000103\t2015\tMauritius\n0.0\t2015\tPuerto Rico\n3.5827734\t2015\tQatar\n0.5460553\t2015\tFinland\n0.0\t2015\tDjibouti\n0.0\t2015\tGreenland\n4.2\t2015\tTajikistan\n0.0\t2015\tLiechtenstein\n4.1980495\t2015\tCzech Republic\n1.9184858\t2015\tBelize\n0.0\t2015\tComoros\n2.6119354\t2015\tKorea, Rep.\n3.0147464\t2015\tParaguay\n0.099994525\t2015\tGuinea\n0.9\t2015\tJamaica\n3.3746939\t2015\tMontenegro\n5.5381007\t2015\tPakistan\n-0.6870505\t2015\tLatin America & the Caribbean (IDA & IBRD countries)\n4.2\t2015\tEgypt, Arab Rep.\n2.3605504\t2015\tHong Kong SAR, China\n0.0\t2015\tSt. Martin (French part)\n3.6053016\t2015\tNiger\n0.0\t2015\tTonga\n1.9663086\t2015\tOECD members\n3.3796084\t2015\tPacific island small states\n0.0\t2015\tTurks and Caicos Islands\n0.29036108\t2015\tEcuador\n3.9848592\t2015\tTurkey\n3.2215757\t2015\tZambia\n6.239188\t2015\tCameroon\n-0.8413194\t2015\tLatin America & Caribbean (excluding high income)\n0.0\t2015\tNauru\n-6.349778\t2015\tSouth Sudan\n5.475269\t2015\tTogo\n0.862105\t2015\tAustria\n1.4993321\t2015\tSuriname\n1.0062737\t2015\tTrinidad and Tobago\n0.0\t2015\tMiddle East & North Africa (excluding high income)\n8.441713\t2015\tCote d'Ivoire\n-0.4\t2015\tKuwait\n4.4\t2015\tMorocco\n3.6652803\t2015\tMacedonia, FYR\n2.978459\t2015\tSub-Saharan Africa (IDA & IBRD countries)\n7.6110578\t2015\tMali\n5.240447\t2015\tBenin\n7.5701303\t2015\tIndia\n6.4851947\t2015\tSenegal\n2.372296\t2015\tArgentina\n0.0\t2015\tCayman Islands\n2.646448\t2015\tCongo, Rep.\n-0.5\t2015\tMoldova\n0.0\t2015\tSao Tome and Principe\n0.0\t2015\tSint Maarten (Dutch part)\n1.6568749\t2015\tEuro area\n3.4353356\t2015\tIBRD only\n1.76048\t2015\tSt. Lucia\n-5.7\t2015\tVenezuela, RB\n1.6877238\t2015\tGermany\n3.957122\t2015\tIceland\n4.7939215\t2015\tIndonesia\n1.5199113\t2015\tAfghanistan\n0.0\t2015\tGambia, The\n0.0\t2015\tIran, Islamic Rep.\n4.44045\t2015\tLeast developed countries: UN classification\n2.56\t2015\tAlbania\n4.9289546\t2015\tNicaragua\n2.5231085\t2015\tCabo Verde\n1.9487596\t2015\tEuropean Union\n-12.193852\t2015\tEquatorial Guinea\n1.7999995\t2015\tChad\n5.649197\t2015\tKenya\n1.634776\t2015\tSamoa\n2.774928\t2015\tGeorgia\n-0.6830085\t2015\tLatin America & Caribbean\n4.1161065\t2015\tEarly-demographic dividend\n2.0661404\t2015\tChile\n3.4396162\t2015\tSudan\n5.7773933\t2015\tPanama\n6.991271\t2015\tMyanmar\n3.7366836\t2015\tRomania\n3.2542548\t2015\tBhutan\n7.811396\t2015\tIreland\n5.486459\t2015\tCentral African Republic\n3.5\t2015\tOman\n3.005814\t2015\tGuyana\n2.757444\t2015\tCosta Rica\n0.759533\t2015\tItaly\n1.7905837\t2015\tPost-demographic dividend\n-3.7266734\t2015\tRussian Federation\n0.0\t2015\tCuba\n0.0\t2015\tIsle of Man\n0.0\t2015\tFrench Polynesia\n0.0\t2015\tCuracao\n0.0\t2015\tLesotho\n0.0\t2015\tVanuatu\n0.0\t2015\tKorea, Dem. People�s Rep.\n"}]},"apps":[],"jobName":"paragraph_1566412844763_710485821","id":"20190821-184044_1889929362","dateCreated":"2019-08-21T18:40:44+0000","dateStarted":"2019-08-21T19:18:08+0000","dateFinished":"2019-08-21T19:18:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:473"},{"text":"%md\n### HQL queries\nFind the best year(s) for GDP growth for each country.  \nThe join is necessary to match a country's max GDP growth to the year(s) it occured.  \nI used ORDER BY just to see how much longer it would take.","user":"anonymous","dateUpdated":"2019-09-17T23:00:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568760161826_-2022132407","id":"20190917-224241_702280524","dateCreated":"2019-09-17T22:42:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18928","dateFinished":"2019-09-17T23:00:39+0000","dateStarted":"2019-09-17T23:00:39+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>HQL queries</h3>\n<p>Find the best year(s) for GDP growth for each country.<br/>The join is necessary to match a country&rsquo;s max GDP growth to the year(s) it occured.<br/>I used ORDER BY just to see how much longer it would take.</p>\n</div>"}]}},{"text":"%spark.sql\nSELECT value, year, maximums.countryname as Country\nFROM (SELECT max(indicatorvalue) as value, countryname\n        FROM wdi_csv_parquet\n        WHERE indicatorCode = 'NY.GDP.MKTP.KD.ZG'\n            AND indicatorValue <> 0\n        GROUP BY countryname) maximums\n    INNER JOIN wdi_csv_parquet\n        ON maximums.value = wdi_csv_parquet.indicatorValue\n        AND maximums.countryname = wdi_csv_parquet.countryname\nORDER BY value DESC","user":"anonymous","dateUpdated":"2019-09-17T22:52:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"value":"string","year":"string","Country":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"value","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"year","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568759124585_969361831","id":"20190917-222524_529344202","dateCreated":"2019-09-17T22:25:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14131","dateFinished":"2019-09-17T22:53:54+0000","dateStarted":"2019-09-17T22:52:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"value\tyear\tCountry\n189.82993\t1965\tOman\n149.97296\t1997\tEquatorial Guinea\n106.27981\t1997\tLiberia\n104.486786\t2012\tLibya\n88.957664\t1996\tBosnia and Herzegovina\n57.81783\t1990\tIraq\n45.302753\t1974\tKiribati\n39.487095\t1974\tGabon\n38.20071\t1991\tLebanon\n35.38456\t1990\tTurkmenistan\n35.22408\t1995\tRwanda\n34.600002\t1988\tNew Caledonia\n34.5\t2000\tAzerbaijan\n34.5\t2006\tAzerbaijan\n34.31373\t1963\tAlgeria\n33.990467\t1993\tKuwait\n33.735775\t2004\tNigeria\n33.62937\t2004\tChad\n30.073698\t1975\tSomalia\n28.696266\t1987\tBhutan\n27.690886\t1964\tMauritania\n26.973917\t2001\tKosovo\n26.845322\t1996\tMozambique\n26.754988\t2004\tMacao SAR, China\n26.40488\t1973\tLesotho\n26.36194\t1972\tBotswana\n26.268576\t2002\tSierra Leone\n26.170246\t2006\tQatar\n26.139296\t1979\tBahamas, The\n25.947592\t1998\tWest Bank and Gaza\n25.83149\t1972\tSt. Vincent and the Grenadines\n25.027607\t1972\tSyrian Arab Republic\n24.542517\t1986\tMarshall Islands\n24.309572\t1976\tJordan\n23.874775\t1980\tUnited Arab Emirates\n23.5977\t1982\tCongo, Rep.\n23.544891\t1990\tSt. Lucia\n23.171246\t1982\tIran, Islamic Rep.\n22.672523\t1973\tSaudi Arabia\n22.593054\t2007\tAngola\n22.565151\t1970\tZimbabwe\n22.562428\t1979\tBrunei Darussalam\n22.173891\t1971\tKenya\n22.003004\t1978\tCameroon\n21.32567\t1970\tBurundi\n21.244144\t2004\tPre-demographic dividend\n21.22141\t1994\tEritrea\n21.200697\t1962\tCongo, Dem. Rep.\n21.151693\t1978\tSeychelles\n21.020649\t2009\tAfghanistan\n21.018\t1990\tSwaziland\n20.654325\t2006\tMaldives\n20.286634\t1985\tMali\n20.266293\t1976\tCyprus\n19.688335\t1981\tCuba\n19.560095\t1975\tMalta\n19.4\t1970\tChina\n19.4\t2011\tChina\n19.182642\t1994\tCabo Verde\n19.105537\t1986\tIsle of Man\n18.286606\t2004\tVenezuela, RB\n18.226683\t1970\tDominican Republic\n18.202286\t1993\tPapua New Guinea\n18.167528\t1981\tGuinea-Bissau\n18.008554\t1972\tJamaica\n18.005667\t1970\tIDA blend\n18.001049\t1974\tFrench Polynesia\n17.742718\t1972\tTunisia\n17.613089\t1964\tCote d'Ivoire\n17.505634\t2000\tTimor-Leste\n17.290777\t2011\tMongolia\n16.728817\t1995\tMalawi\n16.66522\t1976\tSudan\n16.647455\t1965\tZambia\n16.241957\t1968\tIsrael\n16.241243\t1990\tFragile and conflict affected situations\n16.164154\t1976\tHong Kong SAR, China\n15.916227\t1976\tMiddle East & North Africa (IDA & IBRD countries)\n15.916227\t1976\tMiddle East & North Africa (excluding high income)\n15.50122\t1998\tTuvalu\n15.459713\t1965\tTogo\n15.315924\t2007\tPanama\n15.240377\t2010\tSingapore\n15.166518\t1980\tBelize\n15.106996\t1972\tMiddle East & North Africa\n14.787517\t1973\tKorea, Rep.\n14.667397\t1972\tVirgin Islands (U.S.)\n14.627248\t1976\tEgypt, Arab Rep.\n14.582442\t2007\tMonaco\n14.441417\t2003\tTrinidad and Tobago\n14.363636\t1966\tBermuda\n14.260685\t1980\tDominica\n14.192425\t1974\tNicaragua\n14.190637\t1989\tLao PDR\n14.046002\t2011\tGhana\n14.040795\t2003\tArmenia\n14.036278\t2013\tParaguay\n13.978692\t1973\tBrazil\n13.950682\t1973\tEcuador\n13.9\t2000\tTajikistan\n13.9\t1999\tTajikistan\n13.9\t1988\tTajikistan\n13.9\t2002\tTajikistan\n13.85933\t1987\tEthiopia\n13.843995\t2003\tMyanmar\n13.833095\t1983\tVanuatu\n13.501173\t1999\tAlbania\n13.5\t2001\tKazakhstan\n13.5\t1999\tKazakhstan\n13.5\t2012\tKazakhstan\n13.5\t2014\tKazakhstan\n13.5\t2012\tKazakhstan\n13.5\t1999\tKazakhstan\n13.5\t1999\tKazakhstan\n13.5\t1995\tKazakhstan\n13.472612\t1978\tNiger\n13.3764\t2006\tAntigua and Barbuda\n13.351832\t1967\tFiji\n13.288115\t1988\tThailand\n13.273064\t2005\tGrenada\n13.250086\t2005\tCambodia\n13.20003\t1988\tKyrgyz Republic\n13.160728\t1970\tEast Asia & Pacific (excluding high income)\n13.160728\t1970\tEast Asia & Pacific (IDA & IBRD countries)\n13.129731\t2013\tSouth Sudan\n13.060854\t1971\tGreenland\n13.060838\t1971\tIceland\n12.928475\t2011\tSolomon Islands\n12.896334\t1976\tArab World\n12.882468\t1968\tJapan\n12.870007\t1993\tBahrain\n12.66971\t1991\tArgentina\n12.612603\t1970\tPortugal\n12.393429\t1975\tGambia, The\n12.372876\t1996\tMorocco\n12.344\t2007\tGeorgia\n12.308128\t1994\tPeru\n12.27793\t1992\tChile\n12.269548\t2004\tNamibia\n12.1\t1997\tUkraine\n12.1\t1991\tUkraine\n12.1\t2000\tUkraine\n12.1\t1992\tUkraine\n12.1\t1990\tUkraine\n12.1\t2004\tUkraine\n12.1\t1995\tUkraine\n12.1\t1990\tUkraine\n12.1\t2016\tUkraine\n12.1\t1998\tUkraine\n12.1\t2015\tUkraine\n12.034179\t1968\tIndonesia\n12.02392\t2003\tAndorra\n11.90548\t1964\tMexico\n11.902191\t2006\tLatvia\n11.838675\t1961\tSpain\n11.798595\t1997\tEstonia\n11.730911\t1982\tMoldova\n11.714203\t1973\tMalaysia\n11.645651\t1969\tEast Asia & Pacific\n11.60034\t2004\tSub-Saharan Africa (excluding high income)\n11.588021\t2004\tSub-Saharan Africa (IDA & IBRD countries)\n11.588021\t2004\tSub-Saharan Africa\n11.523244\t1995\tUganda\n11.449743\t2004\tBelarus\n11.360282\t1964\tGuyana\n11.353461\t1970\tPakistan\n11.229955\t2004\tIDA total\n11.212815\t1966\tTurkey\n11.1779995\t1997\tIreland\n11.149537\t1961\tGreece\n11.086954\t2007\tLithuania\n11.018513\t1989\tSuriname\n11.014744\t1996\tBurkina Faso\n10.952788\t1964\tBangladesh\n10.944692\t1988\tBulgaria\n10.9000435\t1995\tPalau\n10.848075\t2000\tComoros\n10.834435\t2007\tSlovak Republic\n10.657902\t2007\tMontenegro\n10.583844\t2006\tOther small states\n10.583587\t1986\tSt. Kitts and Nevis\n10.500693\t1976\tHonduras\n10.410924\t1999\tLiechtenstein\n10.259963\t2010\tIndia\n10.016272\t1970\tLate-demographic dividend\n10.0\t2006\tRussian Federation\n10.0\t2003\tRussian Federation\n10.0\t1999\tRussian Federation\n10.0\t1996\tRussian Federation\n10.0\t2002\tRussian Federation\n10.0\t2008\tRussian Federation\n10.0\t2000\tRussian Federation\n10.0\t2011\tRussian Federation\n10.0\t2012\tRussian Federation\n10.0\t2005\tRussian Federation\n10.0\t2010\tRussian Federation\n10.0\t2001\tRussian Federation\n10.0\t2000\tRussian Federation\n10.0\t2007\tRussian Federation\n10.0\t2002\tRussian Federation\n10.0\t2013\tRussian Federation\n10.0\t2001\tRussian Federation\n10.0\t1996\tRussian Federation\n10.0\t2002\tRussian Federation\n10.0\t2004\tRussian Federation\n10.0\t2006\tRussian Federation\n10.0\t2010\tRussian Federation\n10.0\t1999\tRussian Federation\n10.0\t2009\tRussian Federation\n10.0\t2014\tRussian Federation\n10.0\t2000\tRussian Federation\n10.0\t2003\tRussian Federation\n10.0\t2000\tRussian Federation\n9.983934\t1986\tLuxembourg\n9.954231\t1981\tBenin\n9.921154\t2007\tUzbekistan\n9.8546505\t1979\tMadagascar\n9.849452\t2001\tPuerto Rico\n9.8296175\t1965\tCosta Rica\n9.742033\t1986\tMauritius\n9.68113\t1984\tNepal\n9.668261\t2006\tSmall states\n9.593287\t1969\tFinland\n9.541044\t1963\tGuatemala\n9.540481\t1995\tVietnam\n9.481555\t1984\tCentral African Republic\n9.378625\t2007\tLeast developed countries: UN classification\n9.292035\t1995\tSan Marino\n9.269938\t1964\tDenmark\n9.227175\t1973\tLatin America & Caribbean (excluding high income)\n9.144579\t2012\tSri Lanka\n9.115646\t2006\tSao Tome and Principe\n9.08357\t2010\tSouth Asia (IDA & IBRD)\n9.08357\t2010\tSouth Asia\n9.048979\t2007\tUpper middle income\n9.048841\t1972\tCaribbean small states\n9.046513\t2004\tSerbia\n8.920647\t1973\tPhilippines\n8.920504\t1976\tSenegal\n8.89603\t1965\tSouth Africa\n8.809809\t1986\tUruguay\n8.755049\t1973\tLatin America & the Caribbean (IDA & IBRD countries)\n8.692858\t2007\tIBRD only\n8.645224\t2007\tMiddle income\n8.643095\t1965\tNetherlands\n8.6221485\t1973\tLatin America & Caribbean\n8.618244\t2007\tLow & middle income\n8.533192\t2007\tIDA & IBRD total\n8.464381\t2007\tTanzania\n8.46345\t1978\tColombia\n8.458984\t2008\tRomania\n8.394322\t2004\tLower middle income\n8.312726\t1964\tEarly-demographic dividend\n8.207598\t1992\tYemen, Rep.\n8.207246\t1961\tItaly\n8.195589\t2004\tEurope & Central Asia (excluding high income)\n8.1406555\t1993\tMicronesia, Fed. Sts.\n7.9674854\t1972\tBolivia\n7.8144317\t1996\tAruba\n7.7826047\t2006\tEurope & Central Asia (IDA & IBRD countries)\n7.5433373\t1992\tEl Salvador\n7.259087\t1984\tUnited States\n7.2016835\t2007\tPoland\n7.178966\t1996\tSamoa\n7.1668916\t1970\tAustralia\n7.1167793\t1962\tCanada\n7.1167274\t1984\tNorth America\n6.9905305\t1969\tFrance\n6.9591\t2007\tIDA only\n6.9566846\t1964\tBelgium\n6.9535418\t1969\tEuro area\n6.941572\t2007\tSlovenia\n6.8927703\t1962\tHeavily indebted poor countries (HIPC)\n6.8765445\t2006\tCzech Republic\n6.821457\t1964\tSweden\n6.7345076\t2010\tLow income\n6.6795015\t1984\tPacific island small states\n6.645997\t1964\tWorld\n6.645474\t1997\tCroatia\n6.5672135\t2006\tCentral Europe and the Baltics\n6.5584636\t1985\tTonga\n6.5564966\t1964\tOECD members\n6.5399766\t1973\tUnited Kingdom\n6.473487\t2007\tMacedonia, FYR\n6.466701\t1964\tPost-demographic dividend\n6.4625196\t1964\tHigh income\n6.416388\t1993\tNew Zealand\n6.308117\t1988\tGuinea\n6.275867\t1969\tAustria\n6.2733355\t1961\tNorway\n6.100627\t1973\tEuropean Union\n6.008331\t1973\tEurope & Central Asia\n6.0001945\t2014\tDjibouti\n5.8983297\t2007\tChannel Islands\n5.6764426\t2006\tBarbados\n5.523738\t2011\tHaiti\n5.305203\t1994\tCayman Islands\n5.2550063\t1990\tGermany\n4.9377146\t2004\tHungary\n4.330794\t1989\tSwitzerland\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=38"],"interpreterSettingId":"spark"}}},{"text":"%md\nFind the GDP growth for each country, sorted by countryname and year.\nDISTRIBUTE BY countryName ensures the same country cannot be in multiple reducers, as this would cause chunks of data to be in the wrong order.  \nNote that the countries are not sorted lexicographically.","user":"anonymous","dateUpdated":"2019-09-17T23:06:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568760281185_-1849276036","id":"20190917-224441_598212100","dateCreated":"2019-09-17T22:44:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19015","dateFinished":"2019-09-17T23:06:35+0000","dateStarted":"2019-09-17T23:06:35+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Find the GDP growth for each country, sorted by countryname and year.<br/>DISTRIBUTE BY countryName ensures the same country cannot be in multiple reducers, as this would cause chunks of data to be in the wrong order.<br/>Note that the countries are not sorted lexicographically.</p>\n</div>"}]}},{"text":"%spark.sql\nSELECT countryname, year, indicatorvalue as growth\nFROM wdi_csv_parquet\nWHERE indicatorCode = 'NY.GDP.MKTP.KD.ZG'\nDISTRIBUTE BY countryName\nSORT BY countryName, year\nLIMIT 180","user":"anonymous","dateUpdated":"2019-09-17T23:05:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"countryname":"string","year":"string","growth":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568760060178_1589451040","id":"20190917-224100_1743941030","dateCreated":"2019-09-17T22:41:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17791","dateFinished":"2019-09-17T23:05:10+0000","dateStarted":"2019-09-17T23:05:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"countryname\tyear\tgrowth\nSouth Asia\t1960\t0.0\nSouth Asia\t1961\t4.1063704\nSouth Asia\t1962\t3.3139846\nSouth Asia\t1963\t5.378623\nSouth Asia\t1964\t7.6917124\nSouth Asia\t1965\t-1.0054449\nSouth Asia\t1966\t0.9817688\nSouth Asia\t1967\t6.4182982\nSouth Asia\t1968\t4.3628674\nSouth Asia\t1969\t5.9217205\nSouth Asia\t1970\t5.7093334\nSouth Asia\t1971\t0.8010691\nSouth Asia\t1972\t-1.5691278\nSouth Asia\t1973\t3.7544186\nSouth Asia\t1974\t2.2383676\nSouth Asia\t1975\t7.321326\nSouth Asia\t1976\t2.4097538\nSouth Asia\t1977\t6.4277654\nSouth Asia\t1978\t6.0369463\nSouth Asia\t1979\t-3.0608535\nSouth Asia\t1980\t6.5033293\nSouth Asia\t1981\t6.3416743\nSouth Asia\t1982\t3.7611365\nSouth Asia\t1983\t6.7609973\nSouth Asia\t1984\t4.1518283\nSouth Asia\t1985\t5.397761\nSouth Asia\t1986\t4.8088865\nSouth Asia\t1987\t4.171194\nSouth Asia\t1988\t8.574336\nSouth Asia\t1989\t5.4722786\nSouth Asia\t1990\t5.424881\nSouth Asia\t1991\t1.8909587\nSouth Asia\t1992\t5.7157707\nSouth Asia\t1993\t4.4125543\nSouth Asia\t1994\t6.076129\nSouth Asia\t1995\t6.96879\nSouth Asia\t1996\t6.870416\nSouth Asia\t1997\t3.797463\nSouth Asia\t1998\t5.609391\nSouth Asia\t1999\t7.791716\nSouth Asia\t2000\t4.0707917\nSouth Asia\t2001\t4.3243585\nSouth Asia\t2002\t3.7173598\nSouth Asia\t2003\t7.258615\nSouth Asia\t2004\t7.5542727\nSouth Asia\t2005\t8.797876\nSouth Asia\t2006\t8.682969\nSouth Asia\t2007\t8.087746\nSouth Asia\t2008\t3.883499\nSouth Asia\t2009\t7.634751\nSouth Asia\t2010\t9.08357\nSouth Asia\t2011\t6.321694\nSouth Asia\t2012\t5.649628\nSouth Asia\t2013\t6.266687\nSouth Asia\t2014\t6.852434\nSouth Asia\t2015\t7.1963625\nSouth Asia\t2016\t0.0\nChad\t1960\t0.0\nChad\t1961\t1.3977437\nChad\t1962\t5.360116\nChad\t1963\t-1.599454\nChad\t1964\t-2.5109396\nChad\t1965\t0.6062278\nChad\t1966\t-1.8070924\nChad\t1967\t0.76720136\nChad\t1968\t-0.45721886\nChad\t1969\t6.88131\nChad\t1970\t1.8596565\nChad\t1971\t-2.2476263\nChad\t1972\t1.1496161\nChad\t1973\t-8.380883\nChad\t1974\t4.9618526\nChad\t1975\t9.010267\nChad\t1976\t2.9807653\nChad\t1977\t2.2346249\nChad\t1978\t-0.46963418\nChad\t1979\t-21.441088\nChad\t1980\t-6.047671\nChad\t1981\t1.0429181\nChad\t1982\t5.346609\nChad\t1983\t15.678718\nChad\t1984\t2.048899\nChad\t1985\t21.792774\nChad\t1986\t-4.0816674\nChad\t1987\t-2.3888085\nChad\t1988\t15.482359\nChad\t1989\t4.884735\nChad\t1990\t-4.1784725\nChad\t1991\t8.535137\nChad\t1992\t8.001443\nChad\t1993\t-15.709837\nChad\t1994\t10.136888\nChad\t1995\t1.2365493\nChad\t1996\t2.214473\nChad\t1997\t5.6533923\nChad\t1998\t6.95158\nChad\t1999\t-0.68285024\nChad\t2000\t-0.87968105\nChad\t2001\t11.658134\nChad\t2002\t8.49121\nChad\t2003\t14.721667\nChad\t2004\t33.62937\nChad\t2005\t17.332533\nChad\t2006\t0.648262\nChad\t2007\t3.2714996\nChad\t2008\t3.0526915\nChad\t2009\t4.2176957\nChad\t2010\t13.550101\nChad\t2011\t0.0828698\nChad\t2012\t8.882576\nChad\t2013\t5.7000012\nChad\t2014\t6.899985\nChad\t2015\t1.7999995\nChad\t2016\t0.0\nLower middle income\t1960\t0.0\nLower middle income\t1961\t3.6570294\nLower middle income\t1962\t3.5602612\nLower middle income\t1963\t4.905783\nLower middle income\t1964\t6.120545\nLower middle income\t1965\t1.545161\nLower middle income\t1966\t1.0165852\nLower middle income\t1967\t1.9862205\nLower middle income\t1968\t4.6518574\nLower middle income\t1969\t7.886705\nLower middle income\t1970\t8.094143\nLower middle income\t1971\t4.918065\nLower middle income\t1972\t2.2381592\nLower middle income\t1973\t5.15106\nLower middle income\t1974\t5.377444\nLower middle income\t1975\t4.401518\nLower middle income\t1976\t5.724701\nLower middle income\t1977\t6.797637\nLower middle income\t1978\t4.316251\nLower middle income\t1979\t1.7448962\nLower middle income\t1980\t5.4708447\nLower middle income\t1981\t2.7267284\nLower middle income\t1982\t2.7319624\nLower middle income\t1983\t4.262264\nLower middle income\t1984\t2.875993\nLower middle income\t1985\t3.940703\nLower middle income\t1986\t3.1779263\nLower middle income\t1987\t2.6927345\nLower middle income\t1988\t6.2250633\nLower middle income\t1989\t5.535741\nLower middle income\t1990\t4.2136397\nLower middle income\t1991\t1.5719506\nLower middle income\t1992\t2.5644238\nLower middle income\t1993\t2.433007\nLower middle income\t1994\t2.977207\nLower middle income\t1995\t4.774128\nLower middle income\t1996\t5.811335\nLower middle income\t1997\t3.8825073\nLower middle income\t1998\t0.5127248\nLower middle income\t1999\t4.5543313\nLower middle income\t2000\t4.3501215\nLower middle income\t2001\t4.293429\nLower middle income\t2002\t3.8295135\nLower middle income\t2003\t6.322888\nLower middle income\t2004\t8.394322\nLower middle income\t2005\t6.6010895\nLower middle income\t2006\t7.3799076\nLower middle income\t2007\t7.2228303\nLower middle income\t2008\t4.7452397\nLower middle income\t2009\t4.9997277\nLower middle income\t2010\t7.4015527\nLower middle income\t2011\t5.3967385\nLower middle income\t2012\t5.1203284\nLower middle income\t2013\t5.576272\nLower middle income\t2014\t5.5717516\nLower middle income\t2015\t5.476984\nLower middle income\t2016\t0.0\nParaguay\t1960\t0.0\nParaguay\t1961\t6.9002857\nParaguay\t1962\t3.3002586\nParaguay\t1963\t4.7102914\nParaguay\t1964\t4.212477\nParaguay\t1965\t6.167975\nParaguay\t1966\t1.9915034\nParaguay\t1967\t9.150367\nParaguay\t1968\t4.527074\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=41","http://jarvis-bootcamp-m.us-east1-c.c.jarvis-bootcamp.internal:4040/jobs/job?id=42"],"interpreterSettingId":"spark"}}},{"text":"%spark.sql\n","user":"anonymous","dateUpdated":"2019-09-17T22:48:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568760484017_2126785070","id":"20190917-224804_942892482","dateCreated":"2019-09-17T22:48:04+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20337"}],"name":"HiveQL_project_notebook","id":"2ENQXKPTE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"simple","personalizedMode":"false"},"info":{}}